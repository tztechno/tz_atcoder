###############################################
###############################################
###############################################
###############################################
###############################################
###############################################
###############################################
###############################################

[ds]
from collections import deque, defaultdict

def main():

    N, M = map(int, input().split())
    
    tubes = []
    for _ in range(M):
        k = int(input())
        a = list(map(int, input().split()))
        tubes.append(a)
    
    # å„è‰²ãŒã©ã®ç­’ã®ä¸€ç•ªä¸Šã«ã‚ã‚‹ã‹ã‚’è¨˜éŒ²
    color_to_tubes = defaultdict(list)
    
    # å„ç­’ã®ç¾åœ¨ã®å…ˆé ­ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
    top_index = [0] * M
    
    # ã‚­ãƒ¥ãƒ¼ã®æº–å‚™ï¼šå–ã‚Šé™¤ã‘ã‚‹ãƒšã‚¢ã‚’ç®¡ç†
    queue = deque()
    
    # åˆæœŸçŠ¶æ…‹ï¼šå„ç­’ã®ä¸€ç•ªä¸Šã®ãƒœãƒ¼ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
    for i in range(M):

        if top_index[i] < len(tubes[i]):

            color = tubes[i][top_index[i]]
            color_to_tubes[color].append(i)
            
            # åŒã˜è‰²ãŒ2ã¤æƒã£ãŸã‚‰ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ 
            if len(color_to_tubes[color]) == 2:
                queue.append(color)
    
    removed_count = 0
    
    while queue: è¦ç´ ãŒã‚ã‚‹é–“
        color = queue.popleft()
        tube1, tube2 = color_to_tubes[color]
        
        # ãƒœãƒ¼ãƒ«ã‚’å–ã‚Šé™¤ã
        top_index[tube1] += 1
        top_index[tube2] += 1
        
        removed_count += 2
        
        # ç­’1ã®æ–°ã—ã„ä¸€ç•ªä¸Šã®ãƒœãƒ¼ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
        if top_index[tube1] < len(tubes[tube1]):
            new_color1 = tubes[tube1][top_index[tube1]]
            color_to_tubes[new_color1].append(tube1)
            if len(color_to_tubes[new_color1]) == 2:
                queue.append(new_color1)
        
        # ç­’2ã®æ–°ã—ã„ä¸€ç•ªä¸Šã®ãƒœãƒ¼ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
        if top_index[tube2] < len(tubes[tube2]):
            new_color2 = tubes[tube2][top_index[tube2]]
            color_to_tubes[new_color2].append(tube2)
            if len(color_to_tubes[new_color2]) == 2:
                queue.append(new_color2)
    
    # ã™ã¹ã¦ã®ãƒœãƒ¼ãƒ«ãŒå–ã‚Šé™¤ã‘ãŸã‹ãƒã‚§ãƒƒã‚¯
    if removed_count == 2 * N:
        print("Yes")
    else:
        print("No")

if __name__ == "__main__":
    main()
###############################################
###############################################
###############################################
###############################################
###############################################
###############################################
###############################################

ã“ã®å•é¡Œã¯ã€ç­’ã®ä¸€ç•ªä¸Šã«ã‚ã‚‹ãƒœãƒ¼ãƒ«ã®ãƒšã‚¢ã‚’åŒã˜è‰²ã§å–ã‚Šé™¤ã„ã¦ã„ãæ“ä½œã‚’ç¹°ã‚Šè¿”ã—ã¦ã€ã™ã¹ã¦ã®ç­’ã‚’ç©ºã«ã§ãã‚‹ã‹åˆ¤å®šã™ã‚‹å•é¡Œã§ã™ã€‚

## å•é¡Œã®ç†è§£

- å„è‰²ã®ãƒœãƒ¼ãƒ«ã¯ã¡ã‚‡ã†ã©2å€‹ãšã¤å­˜åœ¨
- ç­’ã¯Mæœ¬ã‚ã‚Šã€å„ç­’ã«ã¯ãƒœãƒ¼ãƒ«ãŒç©ã¾ã‚Œã¦ã„ã‚‹
- æ“ä½œï¼šç•°ãªã‚‹2æœ¬ã®ç©ºã§ãªã„ç­’ã‹ã‚‰ä¸€ç•ªä¸Šã®ãƒœãƒ¼ãƒ«ã‚’å–ã‚Šå‡ºã—ã€ãã‚Œã‚‰ãŒåŒã˜è‰²ãªã‚‰æ¨ã¦ã‚‹
- ã™ã¹ã¦ã®ç­’ã‚’ç©ºã«ã§ãã‚‹ã‹åˆ¤å®š

## è§£æ³•ã®æ–¹é‡

ã“ã®å•é¡Œã¯**ã‚°ãƒ©ãƒ•ç†è«–**ã‚’ç”¨ã„ã¦è§£ãã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«è€ƒãˆã¾ã™ï¼š

1. **ç­’ã®ä¸€ç•ªä¸Šã®ãƒœãƒ¼ãƒ«**ã«æ³¨ç›®ã™ã‚‹
2. åŒã˜è‰²ã®ãƒœãƒ¼ãƒ«ãŒ2ã¤ã®ç­’ã®ä¸€ç•ªä¸Šã«ã‚ã‚‹ã¨ãã€ãã‚Œã‚‰ã‚’ãƒšã‚¢ã«ã§ãã‚‹
3. ã“ã®ãƒšã‚¢é–¢ä¿‚ã‚’ã‚°ãƒ©ãƒ•ã§è¡¨ç¾ã™ã‚‹

å…·ä½“çš„ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼š

1. å„è‰²ã«ã¤ã„ã¦ã€ãã®è‰²ãŒã©ã®ç­’ã®ä¸€ç•ªä¸Šã«ã‚ã‚‹ã‹ã‚’è¨˜éŒ²ã™ã‚‹
2. åŒã˜è‰²ãŒ2ã¤ã®ç­’ã®ä¸€ç•ªä¸Šã«ã‚ã‚‹å ´åˆã€ãã‚Œã‚‰ã®ç­’ã®é–“ã«ã€Œä¾å­˜é–¢ä¿‚ã€ãŒã‚ã‚‹ã¨è€ƒãˆã‚‹
3. ã‚­ãƒ¥ãƒ¼ã‚’ä½¿ã£ã¦ã€å–ã‚Šé™¤ã‘ã‚‹ãƒœãƒ¼ãƒ«ã‹ã‚‰é †æ¬¡å‡¦ç†ã™ã‚‹

## ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®èª¬æ˜

1. **ãƒ‡ãƒ¼ã‚¿æ§‹é€ **ï¼š
   - `color_to_tubes`: å„è‰²ãŒç¾åœ¨ã©ã®ç­’ã®ä¸€ç•ªä¸Šã«ã‚ã‚‹ã‹ã‚’è¨˜éŒ²
   - `top_index`: å„ç­’ã§æ¬¡ã«å–ã‚Šå‡ºã™ã¹ããƒœãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
   - `queue`: å–ã‚Šé™¤ã‘ã‚‹è‰²ã®ã‚­ãƒ¥ãƒ¼

2. **å‡¦ç†ã®æµã‚Œ**ï¼š
   - åˆæœŸçŠ¶æ…‹ã§ã€åŒã˜è‰²ãŒ2ã¤ã®ç­’ã®ä¸€ç•ªä¸Šã«ã‚ã‚‹è‰²ã‚’ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ 
   - ã‚­ãƒ¥ãƒ¼ã‹ã‚‰è‰²ã‚’å–ã‚Šå‡ºã—ã€å¯¾å¿œã™ã‚‹ç­’ã®ãƒœãƒ¼ãƒ«ã‚’å–ã‚Šé™¤ã
   - å–ã‚Šé™¤ã„ãŸå¾Œã€ç­’ã®æ–°ã—ã„ä¸€ç•ªä¸Šã®ãƒœãƒ¼ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
   - æ–°ã—ã„ãƒœãƒ¼ãƒ«ã®è‰²ãŒä»–ã®ç­’ã®ä¸€ç•ªä¸Šã®è‰²ã¨ä¸€è‡´ã—ãŸã‚‰ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ 

3. **çµ‚äº†æ¡ä»¶**ï¼š
   - ã™ã¹ã¦ã®ãƒœãƒ¼ãƒ«(2Nå€‹)ãŒå–ã‚Šé™¤ã‘ãŸã‚‰ã€ŒYesã€
   - ãã†ã§ãªã‘ã‚Œã°ã€ŒNoã€

ã“ã®è§£æ³•ã®æ™‚é–“è¨ˆç®—é‡ã¯O(N+M)ã§ã€åˆ¶ç´„å†…ã§åŠ¹ç‡çš„ã«å‹•ä½œã—ã¾ã™ã€‚
###############################################
###############################################
OKã€ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€Œ**åŒã˜è‰²ã®ãƒœãƒ¼ãƒ«ãŒ2ã¤æƒã£ãŸã‚‰å–ã‚Šé™¤ã‘ã‚‹ãƒ‘ã‚ºãƒ«**ã€ã‚’è§£ãã‚‚ã®ã§ã™ã€‚
AtCoderã®ã€ŒABC216 E â€“ Pair of Ballsã€ãªã©ã®ç³»çµ±ã®å•é¡Œã§ã™ã­ã€‚
é †ã‚’è¿½ã£ã¦èª¬æ˜ã—ã¾ã™ã€‚

---

## ğŸ“ å•é¡Œã®ã‚¤ãƒ¡ãƒ¼ã‚¸

* N è‰²ã€M æœ¬ã®ç­’ï¼ˆtubeï¼‰ãŒã‚ã‚‹ã€‚
* å„ç­’ã«ã¯ãƒœãƒ¼ãƒ«ãŒã„ãã¤ã‹å…¥ã£ã¦ã„ã‚‹ã€‚
* **ãƒ«ãƒ¼ãƒ«**ï¼šåŒã˜è‰²ã®ãƒœãƒ¼ãƒ«ãŒåŒæ™‚ã«ã€Œãã‚Œãã‚Œã®ç­’ã®ä¸€ç•ªä¸Šã€ã«ã‚ã‚‹ã¨ãã€ãã®2ã¤ã‚’åŒæ™‚ã«å–ã‚Šé™¤ã‘ã‚‹ã€‚
* æœ€å¾Œã¾ã§å…¨éƒ¨ã®ãƒœãƒ¼ãƒ«ã‚’å–ã‚Šé™¤ã‘ã‚‹ã‹ã©ã†ã‹åˆ¤å®šã™ã‚‹ã€‚

---

## ğŸ“ ã‚³ãƒ¼ãƒ‰ã®æ§‹é€ 

### 1. å…¥åŠ›ã®èª­ã¿è¾¼ã¿

```python
N, M = map(int, input().split())
```

* N: ãƒœãƒ¼ãƒ«ã®è‰²ã®æ•°ï¼ˆè‰²ã¯ 1â€¦Nï¼‰ã€‚
* M: ç­’ã®æœ¬æ•°ã€‚

```python
tubes = []
for _ in range(M):
    k = int(input())
    a = list(map(int, input().split()))
    tubes.append(a)
```

* tubes[i]: iç•ªç›®ã®ç­’ã«å…¥ã£ã¦ã„ã‚‹ãƒœãƒ¼ãƒ«ã®è‰²ï¼ˆå…ˆé ­ãŒä¸Šã«ã‚ã‚‹ãƒœãƒ¼ãƒ«ï¼‰ã€‚

---

### 2. çŠ¶æ…‹ã®ç®¡ç†ç”¨å¤‰æ•°

```python
color_to_tubes = defaultdict(list)
top_index = [0] * M
queue = deque()
```

* `color_to_tubes[color]`:
  ãã®è‰²ãŒ**ç¾åœ¨ã©ã®ç­’ã®ä¸€ç•ªä¸Šã«ã‚ã‚‹ã‹**ã‚’è¨˜éŒ²ã™ã‚‹ãƒªã‚¹ãƒˆã€‚
  â†’ åŒã˜è‰²ãŒ2ã¤ã«ãªã£ãŸã‚‰ã€Œå–ã‚Šé™¤ã‘ã‚‹ã€ã®ã§ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚

* `top_index[i]`:
  iç•ªç›®ã®ç­’ã®ã€Œä»Šã®å…ˆé ­ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€ã€‚
  ï¼ˆå–ã‚Šé™¤ã„ãŸãƒœãƒ¼ãƒ«ã®æ•°ã¶ã‚“é€²ã‚€ï¼‰

* `queue`:
  åŒã˜è‰²ãŒäºŒã¤æƒã£ã¦ã€Œä»Šå–ã‚Šé™¤ã‘ã‚‹è‰²ã€ã®ã‚­ãƒ¥ãƒ¼ã€‚

---

### 3. åˆæœŸçŠ¶æ…‹ã®æ§‹ç¯‰

```python
for i in range(M):
    if top_index[i] < len(tubes[i]):
        color = tubes[i][top_index[i]]
        color_to_tubes[color].append(i)
        
        if len(color_to_tubes[color]) == 2:
            queue.append(color)
```

* å„ç­’ã®æœ€åˆã®ãƒœãƒ¼ãƒ«ï¼ˆindex=0ï¼‰ã‚’è¦‹ã¦ã€
  è‰²ã”ã¨ã®å ´æ‰€ã‚’ `color_to_tubes` ã«è¿½åŠ ã€‚
* åŒã˜è‰²ãŒ2ã¤æƒã£ãŸã‚‰ `queue` ã«å…¥ã‚Œã‚‹ã€‚

---

### 4. ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ï¼ˆãƒœãƒ¼ãƒ«é™¤å»å‡¦ç†ï¼‰

```python
removed_count = 0

while queue:
    color = queue.popleft()
    tube1, tube2 = color_to_tubes[color]
    
    top_index[tube1] += 1
    top_index[tube2] += 1
    removed_count += 2
```

* ã‚­ãƒ¥ãƒ¼ã‹ã‚‰ã€Œä»Šé™¤å»ã§ãã‚‹è‰²ã€ã‚’å–ã‚Šå‡ºã™ã€‚
* ãã®è‰²ãŒã‚ã‚‹2æœ¬ã®ç­’ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—ã€‚
* å…ˆé ­ã‚’1ã¤ãšã¤é€²ã‚ã¦ï¼ˆãƒœãƒ¼ãƒ«é™¤å»ï¼‰ã€é™¤å»æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã€‚

#### æ–°ã—ã„ä¸€ç•ªä¸Šã‚’ç¢ºèªã—ã¦ç™»éŒ²

```python
if top_index[tube1] < len(tubes[tube1]):
    new_color1 = tubes[tube1][top_index[tube1]]
    color_to_tubes[new_color1].append(tube1)
    if len(color_to_tubes[new_color1]) == 2:
        queue.append(new_color1)

if top_index[tube2] < len(tubes[tube2]):
    new_color2 = tubes[tube2][top_index[tube2]]
    color_to_tubes[new_color2].append(tube2)
    if len(color_to_tubes[new_color2]) == 2:
        queue.append(new_color2)
```

* é™¤å»å¾Œã«æ–°ã—ãç¾ã‚ŒãŸä¸€ç•ªä¸Šã®è‰²ã‚‚è¨˜éŒ²ã™ã‚‹ã€‚
* ã‚‚ã—åŒã˜è‰²ãŒ2æœ¬æƒã£ãŸã‚‰å†ã³ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã€‚

â€» `color_to_tubes[color]` ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã„ãªã„ã‘ã©ã€
å•é¡Œãªã„ã®ã¯ã€ŒåŒã˜è‰²ã¯æœ€å¤§2ã¤ã€ã‹ã¤ã€Œå–ã‚Šé™¤ã„ãŸå¾Œã¯ã‚‚ã†ä½¿ã‚ãªã„ã€ãŸã‚ã€‚

---

### 5. æœ€çµ‚åˆ¤å®š

```python
if removed_count == 2 * N:
    print("Yes")
else:
    print("No")
```

* ãƒœãƒ¼ãƒ«ã¯å…¨éƒ¨ã§ Nè‰²Ã—2å€‹ï¼2Nå€‹ã‚ã‚‹ã®ã§ã€
  å…¨éƒ¨å–ã‚Šé™¤ã‘ãŸã‚‰ã€ŒYesã€ã€‚

---

## ğŸ”‘ ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¦ç‚¹

* **åŒã˜è‰²ãŒåŒæ™‚ã«ã€Œä¸Šã€ã«æ¥ã‚‹ã®ã‚’å¾…ã¤**ã€‚
* **å–ã‚Šé™¤ã‘ã‚‹ã‚‚ã®ã‹ã‚‰é †ã«é™¤å»ã—ã¦ã„ã BFS å‹ã®å‡¦ç†**ã€‚
* `color_to_tubes` ã¨ `queue` ã‚’ä½¿ã†ã“ã¨ã§ã€åŠ¹ç‡çš„ã«ç®¡ç†ã—ã¦ã„ã‚‹ã€‚

è¨ˆç®—é‡ã¯ O(ãƒœãƒ¼ãƒ«ç·æ•°) ã§ã€ãƒœãƒ¼ãƒ«ãŒæœ€å¤§ã§ã‚‚ 2N å€‹ãªã®ã§ååˆ†é€Ÿã„ã€‚

---

## ğŸ“ ã¾ã¨ã‚

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€
ã€ŒåŒã˜è‰²ã®ãƒœãƒ¼ãƒ«ãŒ2ã¤æƒã£ãŸã‚‰å–ã‚Šé™¤ãã€æ¬¡ã®ãƒœãƒ¼ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€
ã¨ã„ã†ãƒ‘ã‚ºãƒ«ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ã¦ã„ã¾ã™ã€‚

* `color_to_tubes`: è‰²ã”ã¨ã®ã€Œç¾åœ¨ä¸Šã«ã‚ã‚‹ç­’ã®ãƒªã‚¹ãƒˆã€ã€‚
* `queue`: ä»Šã¾ã•ã«å–ã‚Šé™¤ã‘ã‚‹è‰²ã€‚
* `top_index`: å„ç­’ã®ä½•å€‹ç›®ã¾ã§å–ã‚Šé™¤ã‹ã‚ŒãŸã‹ã€‚

ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã§ã€
æœ€å¾Œã¾ã§ãƒœãƒ¼ãƒ«ã‚’å–ã‚Šé™¤ã‘ã‚‹ã‹ã©ã†ã‹ã‚’åŠ¹ç‡çš„ã«åˆ¤å®šã—ã¦ã„ã¾ã™ã€‚

###############################################
###############################################
###############################################
###############################################
###############################################
