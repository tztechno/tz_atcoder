MOD = 10**9 + 7
BASE = 9973

def rolling_hash(s):
    n = len(s)
    h = [0] * (n + 1)
    p = [1] * (n + 1)
    for i in range(n):
        h[i+1] = (h[i] * BASE + ord(s[i])) % MOD
        p[i+1] = p[i] * BASE % MOD
    return h, p

BASE: ローリングハッシュ計算に使用する基数。通常は大きな素数を選びます。
MOD: ハッシュ値を計算する際に取る余り。これによりハッシュ値が一定の範囲に収まるように調整されます。
s: ハッシュを計算したい文字列。
n: 文字列 s の長さ。
h: ローリングハッシュの累積ハッシュ値を保持するリスト。h[i] は文字列の最初から i 文字目までのハッシュ値を格納しています。
p: ローリングハッシュ計算に使用する乗数を保持するリスト。p[i] は BASE を i 回掛けた値を MOD で割った余りを格納しています。

